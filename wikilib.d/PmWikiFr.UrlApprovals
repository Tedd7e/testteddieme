version=pmwiki-2.2.30 ordered=1 urlencoded=1
author=jdd
charset=UTF-8
csum=
ctime=1144177025
name=PmWikiFr.UrlApprovals
rev=24
targets=Site.AllRecentChanges,PmWikiFr.Blocklist,PmWikiFr.Security,PmWikiFr.IndexDocAdmin
text=(:title Approbation des URLs:)%0a%0a(:Summary: Approbation des liens vers des URL:)%0aCette page explique comment décourager le spam par incorporation de liens dans votre wiki, en utilisant le script ''urlapprove.php'' de PmWiki. Ce script est inclu dans les fichiers PmWiki mais n'est pas activé par défaut.%0a%0a!! Utiliser ''urlapprove.php''%0aLes spammers essaient parfois (souvent, même) d'ajouter un grand nombre de liens URL, parfois cachés, car ils escomptent améliorer leur classement dans les moteurs de recherche, ce qui est illusoire, PmWiki ayant un mécanisme pour [[#nofollow |contrer cela]]. De surcroit, le script ''urlapprove.php'' s'oppose à cette action des spammers en:%0a%0a* demandant l'approbation des liens externes avant qu'ils soient incorporés au wiki%0a* vous permettant de limiter le nombre de liens pouvant être ajoutés à une page sans approbation%0a%0aPour valider ''urlapprove.php'', ajoutez ceci au fichier de configuration:%0a->[@include_once('scripts/urlapprove.php');@]%0a%0aPar défaut, les liens non approuvés affichent ce qui devrait être affiché normalement (l'URL ou un texte), et juste à côté un lien [-%25blue%25(approuver les sites)%25%25-].%0a%0aUn clic sur ce lien approuve toutes les URL non approuvées de la page, mais uniquement si vous avez les droits d'écriture dans la page [@Site.ApprovedUrls@] (les pages du groupe "site" sont en général réservées à l'administrateur).%0a%0aVous pouvez aussi approuver d'avance des URL en les inscrivant dans la page [Site.ApprovedUrls]].%0a%0a!!! Limiter les URL non approuvées sur une page%0aVous pouvez limiter le nombre d'URL non approuvées sur une page. Si cette limite est dépassée, la page ne peut pas être sauvegardée. C'est utile car les spammers écrivent en général de très longues listes d'URL, ce qui est rare pour les auteurs normaux.%0a%0aExample: Pour instaurer une limite de 5 liens non approuvés, ajoutez ce qui suit au fichier de configuration:%0a%0a->[@$UnapprovedLinkCountMax = 5;@]%0a->[@include_once('scripts/urlapprove.php');@]%0a%0aNotez que $UnapprovedLinkCountMax doit être placé ''avant'' ''urlapprove.php''.%0a%0a!!! Gestion des URL non approuvées%0aVous pouvez changer le message défini dans la variable $UnapprovedLinkFmt, par example:%0a-> [@%0ainclude_once('scripts/urlapprove.php');%0a$UnapprovedLinkFmt =%0a "[$[Link requires approval]]%3ca class='apprlink'%0a  href='\$PageUrl?action=approvesites'>$[(approve)]%3c/a>";%0a@]%0a%0a"Link requires approval" est à remplacer par un texte affiché à la place du lien à approuver, "(approve)" est le texte qui apparait en bleu. Attention, la gestion des accents dans ces variables est problématique. L'usage de cette possiblité est particulièrement utile si vous voulez que le lien non approuvé soit toujours masqué.%0a%0aSi vous voulez totalement interdire les liens non approuvés, vous pouvez utiliser%0a->[@$UnapprovedLinkFmt = "%3cb>Les liens externes ne sont pas autorises%3c/b>";@]%0a%0a!!! Particularité du menu SideBar%0aNotez qu'en général vous devez aller sur la page Sidebar pour approuver les liens, car le mécanisme d'approbation ne fonctionne que pour la page courante.%0a%0a!!! Configuration initiale%0aAprès la configuration initiale, tous les liens existants deviennent non approuvés.%0a%0aPour trouver quelles pages sont affectées, vous pouvez utiliser un flux RSS sur [[Site/AllRecentChanges]]. %0a%0a!! Astuces techniques%0a[[#whiteurls]]%0a!!! Liste blanche d'URL%0aLes Urls peuvent aussi être approuvées en les ajoutant à une liste blanche, definie dans la variable @@$WhiteUrlPatterns@@, qui est configurée dans le fichier de configuration ''local/config.php'' file. Pour ajouter des URL multiples, utilisez le séparateur @@|@@ (barre verticale). Par exemple%0a-> [@%0a$WhiteUrlPatterns =%0a  "http://example.com/|http://example.net/|http://example.org/";%0a@]%0a%0aPour ajouter toutes les URl venant, disons, de nouvelle zélande, faire:%0a-> [@%0a$WhiteUrlPatterns[] = 'http://[^/] \\.nz';%0a$WhiteUrlPatterns[] = 'http://[^/] \\.au';%0a@]%0a%0a!!! Changer le nom de la page d'approbation des URL%0aSi vous voulez changer le nom par défaut [@Site.ApprovedUrls@] écrivez dans @@local/config.php@@, après le lien d'inclusion du script:%0a->[@$ApprovedUrlPagesFmt = array('Autregroupe.Autrenom');@]%0a%0aEn général ce sera (comme toujours, éviter de traduire les noms de page):%0a->[@array('$DefaultGroup.ApprovedUrls');@]%0a%0a!!! Voir l'URL à approuver%0aQuand le lien n'est pas affiché, il faut éditer la page pour le voir. Une bulle affichant l'URL peut-être affichée quand vous passez le curseur au dessus du lien [-%25blue%25(approuver les sites)%25%25-]. [[http://uuu.example.com|Example]]%0a%0aAjoutez dans ''local/config.php'':%0a%0a-> [@%0a$UnapprovedLinkFmt =%0a  "\$LinkText%3ca class='apprlink' href='\$PageUrl?action=approvesites'%0a   title='\$LinkUrl'>$[(approuver les sites)]%3c/a>";%0a@]%0a%0a(c'est la balise ''title'' qui fait le travail - le résultat peut dépendre du navigateur)%0a%0a->Voir la page en anglais pour une astuce appliquée à Safari%0a%0a!! Concernant rel='nofollow' [[#nofollow]]%0aPar défaut, PmWiki crée des liens externes qui ne sont pas suivis par les robots. Ici les notes de la version pmwiki-2.0.beta20 (30-Jan-2005):%0a%0a->''D'abord, la variable $UrlLinkFmt a été modifiée de façon que les liens vers des URL externes aient automatiquement l'attribut rel='nofollow' pour aider à combattre le spam comme décrit ici [http://googleblog.blogspot.com/2005/01/preventing-comment-spam.html]]. Les administrateurs peuvent adapter $UrlLinkFmt et $UnapprovedLinkFmt pour fournir ou omettre  rel='nofollow' à leur guise.%0a!! Voir aussi%0a%0a* [[PmWikiFr/Blocklist]] - Bloquer les posts en fonction du contenu ou de l'IP;%0a* [[PmWikiFr/Security]] - Assurer la sécurité de votre PmWIki%0a%0a----%0a%25trail%25%3c%3c|[[Index doc admin]]|>>
time=1315669216
title=Approbation des URLs
